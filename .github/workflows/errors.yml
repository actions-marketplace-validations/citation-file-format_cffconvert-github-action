on: push

jobs:
  verify:
    name: "Verify errors"
    runs-on: ubuntu-latest
    steps:
      # This step checks out a copy of your repository.
      - uses: actions/checkout@v2

      # run the checks on a series of directories
      - uses: citation-file-format/cffconvert-github-action@tests
        with:
          WORKDIR: non-existing-directory/
          FAILURE_EXPECTED: '1'

      - uses: citation-file-format/cffconvert-github-action@tests
        with:
          WORKDIR: tests/cff-missing/
          FAILURE_EXPECTED: '1'

      - uses: citation-file-format/cffconvert-github-action@tests
        with:
          WORKDIR: tests/zenodo-missing/
          FAILURE_EXPECTED: '1'

      - uses: citation-file-format/cffconvert-github-action@tests
        with:
          WORKDIR: tests/zenodo-not-equivalent/
          FAILURE_EXPECTED: '1'

      - uses: citation-file-format/cffconvert-github-action@tests
        with:
          WORKDIR: tests/zenodo-with-extra-whitespace/
          FAILURE_EXPECTED: '0'
          DIFF_IGNORE_WHITESPACE: ''

      - uses: citation-file-format/cffconvert-github-action@tests
        with:
          WORKDIR: tests/zenodo-with-extra-whitespace/
          FAILURE_EXPECTED: '0'
          DIFF_IGNORE_WHITESPACE: '1'

      - name: final
        uses: citation-file-format/cffconvert-github-action@tests
        with:
          WORKDIR: tests/zenodo-with-extra-whitespace/
          FAILURE_EXPECTED: '1'
          DIFF_IGNORE_WHITESPACE: '0'
